# CVE-2019-10744

## 漏洞详情

![](https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200612011224.png)

通过构造函数重载的方式

`Lodash` 库中的函数 `defaultsDeep` 很有可能会被欺骗添加或修改 `Object.prototype` 的属性

最终导致`Object`原型被修改，可能会触发 `RCE`或身份绕过等风险.

![](https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200612010151.png)

## 复现方式

```shell
npm install lodash@4.17.11
```

运行 `exp` 即可触发原型链污染，进而构造命令执行

## 防范措施

- 冻结 Object.prototype ，使原型不能扩充属性

- 建立 JSON schema

- 规避不安全的递归性合并函数

- 使用无原型对象，打破原型链并防止污染。

- 采用新的 Map 数据类型，代替 Object 类型
